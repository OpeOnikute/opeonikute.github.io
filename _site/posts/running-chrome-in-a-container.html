<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Running Chrome in a container</title>
    <meta
      name="description"
      content=""
    />

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@Ope__O" />
    <meta name="twitter:title" content="Opeyemi Onikute | Kilon Pop?" />
    <meta
      name="twitter:description"
      content=""
    />
    <meta name="twitter:creator" content="@Ope__O" />

    <meta
      name="twitter:image"
      content=""
    />

    <!-- Open Graph data -->
    <meta property="og:title" content="Opeyemi Onikute | Kilon Pop?" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://opeonikute.github.io" />
    <meta
      property="og:image"
      content="https://opeonikute.github.io/img/favicon/android-icon-192x192.png"
    />
    <meta
      property="og:description"
      content=""
    />
    <meta property="og:site_name" content="Opeyemi Onikute" />

    <link
      href="https://fonts.googleapis.com/css?family=PT+Sans:400,700"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/css/style.css" />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="/img/favicon/apple-icon-114x114.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/img/favicon/favicon-16x16.png"
    />
    <link rel="manifest" href="/img/favicon/manifest.json" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="/js/highlight/styles/vs2015.css">
  </head>
  <body>
    <header>
        <div>
            <a href="/" class="brand"></a>
            <a href="/blog" class="text">Thoughts and Notions</a>
        </div>
        <div class="pull-right social-links">
            <span><a href="https://twitter.com/Ope__O" target="_blank"><i class="fa fa-twitter"></i></a></span>
            <span><a href="https://github.com/opeonikute"><i class="fa fa-github" target="_blank"></i></a></span>
            <span><a href="https://www.linkedin.com/in/opeyemi-onikute-a97779b9/"><i class="fa fa-linkedin" target="_blank"></i></a></span>
        </div>
    </header>
    <main class="blog dark">
      <div class="blog-title">
        <h1>Running Chrome in a container</h1>
        <h2> (June 2019)</h3>
      </div>
      <p>I thought this wasn’t gonna be possible because MacOS, but it blew my mind when it did so, blogpost. I found <a href="https://github.com/jessfraz/dockerfiles/blob/master/chrome/beta/Dockerfile">this Dockerfile</a> from <a href="https://github.com/jessfraz">Jess Frazelle</a>’s amazing repo that contains dockerfiles for a bunch of stuff.</p>

<h3 id="steps">Steps</h3>

<ol>
  <li>
    <p><strong>Ensure you have xhost running.</strong></p>

    <p>XQuartz is a tool that allows you give access to your screen over a network. You can follow the instructions <a href="https://sourabhbajaj.com/blog/2017/02/07/gui-applications-docker-mac/">here</a> to install XQuartz so you can do that.</p>
  </li>
  <li>
    <p><strong>Get your machine IP.</strong></p>

    <p>For this, you can run <code class="highlighter-rouge">IP=$(ifconfig en0 | grep inet | awk '$1=="inet" {print $2}')</code> and then <code class="highlighter-rouge">echo $IP</code>. I added it to the .sh file straight so doing this would be just to be sure.</p>
  </li>
  <li>
    <p><strong>Add machine IP to xhost access.</strong></p>

    <p>Simply run <code class="highlighter-rouge">xhost + $IP</code> to do this.</p>
  </li>
  <li>
    <p><strong>Download chrome.json file</strong></p>

    <p>You need the chrome.json file in your home directory, so run</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> cd $HOME &amp;&amp; curl https://raw.githubusercontent.com/jfrazelle/dotfiles/master/etc/docker/seccomp/chrome.json -O ~/chrome.json 
</code></pre></div>    </div>

    <p>You can use <code class="highlighter-rouge">wget</code> too but I don’t have that installed.</p>
  </li>
  <li>
    <p><strong>Create run.sh file to run the build.</strong></p>

    <p>I had to remove the <code class="highlighter-rouge">/dev/snd</code> and all other <code class="highlighter-rouge">dev</code> stuff (which would’ve provided access to the machine’s sound etc) because MacOS doesn’t allow you access to the hardware from shell, but you should be fine if you’re on Ubuntu or something similar.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> IP=$(ifconfig en0 | grep inet | awk '$1=="inet" {print $2}')
 DISPLAY=$IP:0
 docker run -it \
     --net host \
     --cpuset-cpus 0 \
     --memory 512mb \
     -v /tmp/.X11-unix:/tmp/.X11-unix \
     -e DISPLAY=$DISPLAY \
     -v $HOME/Downloads:/home/chrome/Downloads \
     -v $HOME/.config/google-chrome/:/data \
     --security-opt seccomp=$HOME/chrome.json \
     -v /dev/shm:/dev/shm \
     --name chrome \
     jess/chrome:beta
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Run the script.</strong></p>
  </li>
</ol>

<p>You might see a bunch of errors like these, but they won’t stop Chrome from <em>popping up like a hungry friend when you’re cooking</em>.</p>

<p><img src="/media/Screen_Shot_2019-05-31_at_18-3dc3bc3e-c0dd-4f85-947f-b1b14853fcc0.04.52.png" alt="" /></p>

<p>If you get this to work too, feel free to shoutout. Shoutout to <a href="https://twitter.com/jessfraz">Jess</a> also for her Dockerfiles repo.</p>

<p>Shalom.</p>

    </main>
    <footer>
      <small>&copy; Ope Onikute. </small> <small class="pull-right"><a href="https://twitter.com/Ope__O" target="_blank">@Ope__O</a></small> 
    </footer>
    <script src="/js/app.js"></script>
    <script src="/js/highlight/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>
